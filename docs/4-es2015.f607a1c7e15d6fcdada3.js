(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{GTNQ:function(e,t){},HimD:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var s=i("2Vo4"),n=i("8Y7J");let r=(()=>{class e{constructor(){this.data={tariffs:new s.a(null),editable:new s.a(null)}}clean(){Object.keys(this.data).forEach(e=>this.data[e].next(null))}}return e.ngInjectableDef=n["\u0275\u0275defineInjectable"]({factory:function(){return new e},token:e,providedIn:"root"}),e})()},QpM1:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var s=i("mrSG"),n=i("bP2Y"),r=i("+ma8"),o=i("fet1"),h=i("AytR"),a=i("B43R"),u=i("lJxs"),c=(i("GTNQ"),i("8Y7J"));let l=(()=>{class e{constructor(e,t,i,s){this.http=e,this.utils=t,this.urls=i,this.tokenService=s}getCurrentUser(e,t){const i=this.urls.getCurrentUserUrl(e);return this.http.get(i,null,t).pipe(Object(u.a)(e=>e.data))}login(e){const t=this.urls.getLoginUrl();return this.postWithAppToken(t,e)}confirmEmailWithCode(e){const t=this.urls.getConfirmEmailWithCodeUrl();return this.postWithAppToken(t,e)}signUp(e){const t=this.urls.getHotelierRegisterUrl();return this.postWithAppToken(t,e)}sendNewConfirmEmail(e){const t=this.urls.getSendNewConfirmEmailUrl();return this.postWithAppToken(t,e)}restorePassword(e){const t=this.urls.getRestorePassword();return this.postWithAppToken(t,e)}changePassword(e){const t=this.urls.getChangePassword();return this.postWithAppToken(t,e)}getAppToken(){const e=this.urls.getAppTokenUrl();return this.http.post(e,null,h.a.appToken)}getSources(){const e=this.tokenService.getToken("userToken"),t=this.urls.getSourcesUrl();return this.http.get(t,null,e)}getRates(e){const t=this.tokenService.getToken("userToken"),i=this.urls.getRatesUrl(e);return this.http.get(i,null,t)}getRoomTypes(){const e=this.tokenService.getToken("userToken"),t=this.urls.getRoomTypesUrl();return this.http.get(t,null,e)}getBookings(e){const t=this.tokenService.getToken("userToken"),i=this.urls.getBookingsUrl(1);return this.http.get(i,e,t)}getSingleBooking(e){const t=this.tokenService.getToken("userToken"),i=`${this.urls.getBookingsUrl(1)}/${e}`;return this.http.get(i,null,t).pipe(Object(u.a)(e=>e.data))}getGuests(e){const t=this.tokenService.getToken("userToken"),i=this.urls.getGuestsUrl(1);return this.http.get(i,e,t)}getSingleGuest(e){const t=this.tokenService.getToken("userToken"),i=`${this.urls.getGuestsUrl(1)}/${e}`;return this.http.get(i,null,t).pipe(Object(u.a)(e=>e.data))}addSingleGuestForReservation(e,t){const i=this.tokenService.getToken("userToken"),s=this.urls.getGuestOfReservationsUrl(1,e);return this.http.post(s,t,i)}deleteSingleGuestForReservation(e,t){const i=this.tokenService.getToken("userToken"),s=`${this.urls.getGuestOfReservationsUrl(1,e)}/${t}`;return this.http.delete(s,i)}updateSingleGuest(e,t){const i=this.tokenService.getToken("userToken"),s=`${this.urls.getGuestsUrl(1)}/${e}`;return this.http.put(s,t,i)}getSearchPrice(e,t,i,s){const n=this.tokenService.getToken("userToken"),r=this.urls.getSearchPrice(e,t,i,s);return this.http.get(r,null,n)}getSearchPriceWithoutParams(e){const t=this.tokenService.getToken("userToken"),i=this.urls.getSearchPriceWitoutParams();return this.http.get(i,e,t)}getPrice(e,t,i,n,r,o){return s.__awaiter(this,void 0,void 0,(function*(){const s=this.tokenService.getToken("userToken"),h=this.urls.getPrice(e,t,i,n,r,o);return(yield this.http.get(h,null,s)).toPromise()}))}getPriceNonAsync(e,t){const i=this.tokenService.getToken("userToken"),s=this.urls.getPriceWitoutParams(e);return this.http.get(s,t,i)}getProfileData(){const e=this.tokenService.getToken("userToken"),t=this.urls.getProfileData();return this.http.get(t,null,e)}getActiveNoteList(e){const t=this.tokenService.getToken("userToken"),i=this.urls.getActiveNoteListUrl(1,e);return this.http.get(i,null,t)}getArchivedNoteList(e){const t=this.tokenService.getToken("userToken"),i=this.urls.getArchivedNoteListUrl(1,e);return this.http.get(i,null,t)}addBookingNote(e,t){const i=this.tokenService.getToken("userToken"),s=this.urls.getActiveNoteListUrl(1,e);return this.http.post(s,t,i)}getGuestActiveNoteList(e){const t=this.tokenService.getToken("userToken"),i=this.urls.getGuestActiveNotesUrl(1,e);return this.http.get(i,null,t)}getGuestArchivedNoteList(e){const t=this.tokenService.getToken("userToken"),i=this.urls.getGuestArchivedNotesUrl(1,e);return this.http.get(i,null,t)}addGuestNote(e,t){const i=this.tokenService.getToken("userToken"),s=this.urls.getGuestActiveNotesUrl(1,e);return this.http.post(s,t,i)}updateGuestNote(e,t,i){const s=this.tokenService.getToken("userToken"),n=this.urls.getDeleteGuestActiveNoteListUrl(1,e,t);return this.http.put(n,i,s)}addBookings(e){const t=this.tokenService.getToken("userToken"),i=this.urls.getBookingsUrl(1);return this.http.post(i,e,t)}cancelReservation(e){const t=this.tokenService.getToken("userToken"),i=this.urls.getReservationCancelUrl(1,e);return this.http.patch(i,null,t)}setNoShowStatusToReservation(e){const t=this.tokenService.getToken("userToken"),i=this.urls.getReservationNoShowStatusSettingUrl(1,e);return this.http.patch(i,null,t)}addGuest(e){const t=this.tokenService.getToken("userToken"),i=this.urls.getGuestsUrl(1);return this.http.post(i,e,t)}deleteActiveBookingNote(e,t){const i=this.tokenService.getToken("userToken"),s=this.urls.getDeleteActiveNoteListUrl(1,e,t);return this.http.delete(s,i)}deleteArchivedBookingNote(e,t){const i=this.tokenService.getToken("userToken"),s=this.urls.getDeleteArchivedNoteListUrl(1,e,t);return this.http.delete(s,i)}deleteGuestActiveNote(e,t){const i=this.tokenService.getToken("userToken"),s=this.urls.getDeleteGuestActiveNoteListUrl(1,e,t);return this.http.delete(s,i)}deleteGuestArchivedNote(e,t){const i=this.tokenService.getToken("userToken"),s=this.urls.getDeleteGuestArchivedNoteListUrl(1,e,t);return this.http.delete(s,i)}updateGuest(e,t){const i=this.tokenService.getToken("userToken"),s=`${this.urls.getGuestsUrl(1)}/${e}`;return this.http.put(s,t,i)}updateProfileData(e){const t=this.tokenService.getToken("userToken"),i=this.urls.getUpdateProfile();return this.http.put(i,e,t)}updatePassword(e){const t=this.tokenService.getToken("userToken"),i=this.urls.getUpdatePassword();return this.http.put(i,e,t)}updateEmail(e){const t=this.tokenService.getToken("userToken"),i=this.urls.getUpdateEmail();return this.http.put(i,e,t)}updateAvatar(e){const t=this.tokenService.getToken("userToken"),i=this.urls.getUpdateAvatar();return this.http.post(i,e,t)}postWithAppToken(e,t,i){return s.__awaiter(this,void 0,void 0,(function*(){let n=this.tokenService.getToken("appToken");return n?this.http.post(e,t,n,i):(yield this.getAppToken().toPromise().then(e=>s.__awaiter(this,void 0,void 0,(function*(){n=this.utils.tokenObjToString(e),this.tokenService.setToken(n,"appToken"),this.tokenService.setToken(new Date,"lastUpdate")}))),this.http.post(e,t,n,i))}))}}return e.ngInjectableDef=c["\u0275\u0275defineInjectable"]({factory:function(){return new e(c["\u0275\u0275inject"](n.a),c["\u0275\u0275inject"](a.a),c["\u0275\u0275inject"](o.a),c["\u0275\u0275inject"](r.a))},token:e,providedIn:"root"}),e})()},"RL7/":function(e,t,i){"use strict";var s=i("2Vo4"),n=i("/uUt"),r=i("+ma8"),o=i("QpM1"),h=i("fet1"),a=i("B43R"),u=i("jcG0"),c=i("v8gK"),l=i("HimD"),k=i("UzXn"),g=i("8Y7J");let v=(()=>{class e{constructor(e,t,i,s){this.hotelService=e,this.newHotelCreationService=t,this.tariffPlansService=i,this.navBarService=s}cleanAll(){this.hotelService.clean(),this.newHotelCreationService.clean(),this.tariffPlansService.clean(),this.navBarService.clean()}clean(e){this[e].clean()}}return e.ngInjectableDef=g["\u0275\u0275defineInjectable"]({factory:function(){return new e(g["\u0275\u0275inject"](u.a),g["\u0275\u0275inject"](c.a),g["\u0275\u0275inject"](l.a),g["\u0275\u0275inject"](k.a))},token:e,providedIn:"root"}),e})();var p=i("C5ip"),d=i("iInd");i.d(t,"a",(function(){return S}));let S=(()=>{class e{constructor(e,t,i,r,o,h,a,u,c,l){this.tokenService=e,this.apiService=t,this.urls=i,this.router=r,this.hotelService=o,this.newHotelCreationService=h,this.utils=a,this.cleanerService=u,this.navBarService=c,this.hotelierApi=l,this.isAuthenticatedSubject=new s.a(!1),this.authenticatedUserSubject=new s.a({}),this.isAuthenticated=this.isAuthenticatedSubject.asObservable().pipe(Object(n.a)()),this.authenticatedUser=this.authenticatedUserSubject.asObservable().pipe(Object(n.a)());const k=this.tokenService.getToken("userToken"),g=this.tokenService.getToken("user");k&&g&&this.setAuthenticatedUser(this.tokenService.getToken("user"))}setAuthenticatedUser(e){return this.isAuthenticatedSubject.next(!0),this.authenticatedUserSubject.next(e),this.tokenService.setToken("","email"),e}logInIfAlreadyAuthenticated(){return this.apiService.getCurrentUser("hotelier",this.tokenService.getToken("userToken"))}getIsAuthenticated(){return this.isAuthenticatedSubject.value}getAuthenticatedUser(){return this.authenticatedUserSubject.value}logIn(e,t){return this.apiService.login({username:e,password:t,role:"hotelier"}).then(e=>e.toPromise().then(e=>{const t=this.utils.tokenObjToString(e);return this.tokenService.setToken(t,"userToken"),this.apiService.getCurrentUser("hotelier",t).toPromise().then(e=>this.setAuthenticatedUser(e),e=>this.logOut())}))}setTokenByHotels(){this.hotelierApi.getHotels().toPromise().then(e=>{if(this.hotelService.hotels.next(e),1===e.length)if(this.tokenService.setToken(!1,"has-hotels"),this.navBarService.data.currentHotel.next(e[0]),!e||e.find(e=>"published"===e.status)||!this.tokenService.getToken("hotelInCreation")&&void 0!==this.tokenService.getToken("has-hotels"))this.router.navigate([""]);else{const t=e.find(e=>"registration"===e.status&&e.step<4);t||(this.router.navigate([""]),this.router.navigate(["hotel/all"]),this.tokenService.setToken(!0,"has-hotels")),this.tokenService.setToken(e[0].id,"hotelInCreation"),this.router.navigate(["hotel","new-hotel"],{queryParams:{step:t.step}})}else e.length>1?(this.router.navigate(["hotel/all"]),this.tokenService.setToken(!0,"has-hotels")):(this.tokenService.setToken(!1,"has-hotels"),this.router.navigate(["hotel/new-hotel"]))})}logOut(){this.tokenService.removeToken(),this.isAuthenticatedSubject.next(!1),this.authenticatedUserSubject.next(null),this.cleanerService.cleanAll()}signUp(e){return e.password_confirmation=e.password,this.apiService.signUp(e).then(e=>e.toPromise().then(e=>(this.tokenService.setToken(e.data.email,"email"),e.data)))}confirmEmailWithCode(e){const t={token:e,email:this.tokenService.getToken("email"),role:"hotelier"};return this.apiService.confirmEmailWithCode(t).then(e=>e.toPromise().then(e=>{const t=this.utils.tokenObjToString(e);return this.tokenService.setToken(t,"userToken"),this.apiService.getCurrentUser("hotelier",t).toPromise().then().catch(()=>{this.logOut()})}))}sendNewConfirmEmail(){const e={email:this.tokenService.getToken("email"),role:"hotelier"};return this.apiService.sendNewConfirmEmail(e).then(e=>e.toPromise())}restorePassword(e){return this.apiService.restorePassword({email:e,role:"hotelier"}).then(t=>(this.tokenService.setToken(e,"email"),t.toPromise()))}changePassword(e){const t=Object.assign({},e,{email:this.tokenService.getToken("email"),role:"hotelier"});return this.apiService.changePassword(t).then(e=>e.toPromise())}}return e.ngInjectableDef=g["\u0275\u0275defineInjectable"]({factory:function(){return new e(g["\u0275\u0275inject"](r.a),g["\u0275\u0275inject"](o.a),g["\u0275\u0275inject"](h.a),g["\u0275\u0275inject"](d.m),g["\u0275\u0275inject"](u.a),g["\u0275\u0275inject"](c.a),g["\u0275\u0275inject"](a.a),g["\u0275\u0275inject"](v),g["\u0275\u0275inject"](k.a),g["\u0275\u0275inject"](p.a))},token:e,providedIn:"root"}),e})()},UzXn:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var s=i("2Vo4"),n=i("8Y7J");let r=(()=>{class e{constructor(){this.data={currentHotel:new s.a(null),tariffHotel:new s.a(null)}}clean(){Object.keys(this.data).forEach(e=>this.data[e].next(null))}}return e.ngInjectableDef=n["\u0275\u0275defineInjectable"]({factory:function(){return new e},token:e,providedIn:"root"}),e})()},jcG0:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var s=i("2Vo4"),n=i("8Y7J");let r=(()=>{class e{constructor(){this.hotels=new s.a([])}ngOnDestroy(){}clean(){this.hotels.next([])}}return e.ngInjectableDef=n["\u0275\u0275defineInjectable"]({factory:function(){return new e},token:e,providedIn:"root"}),e})()},v8gK:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var s=i("2Vo4"),n=i("XNiG"),r=i("C5ip"),o=i("B43R"),h=i("+ma8"),a=i("UzXn"),u=i("8Y7J"),c=i("iInd");let l=(()=>{class e{constructor(e,t,i,r,o){this.router=e,this.utils=t,this.hotelierApi=i,this.tokenService=r,this.navBarService=o,this.reservation=new s.a(null),this.reservationBuildings=new s.a([]),this.reservationRooms=new s.a([]),this.reservationRoomsType=new s.a([]),this.reservationBuildingRooms=new s.a([]),this.reservationServices=new s.a(null),this.reservationServicesGroups=new s.a(null),this.reservationLanguages=new s.a(null),this.reservationCities=new s.a(null),this.reservationObjectTypes=new s.a(null),this.navigationHandler=new n.a,this.canGoNext=new s.a(!1),this.onNavigateResponse=new n.a,this.updateHandler=new n.a,this.onCompleteHandler=new n.a}ngOnDestroy(){this.hotelierApiSubscription.unsubscribe()}clean(){this.reservation.next(null),this.reservationBuildings.next([])}navigateToNextStep(e,t){const i=Object.assign({},this.reservation.getValue(),e);"done"===t?(i.status="complete",this.hotelierApiSubscription=this.hotelierApi.updateHotelInfo(this.utils.normalizeReservationData(i),this.reservation.getValue().id).subscribe(e=>{this.updateHandler.next(e),this.tokenService.setToken(null,"hotelInCreation"),this.tokenService.setToken(!0,"has-hotels"),this.tokenService.setToken(e.id,"hotel-id"),this.navBarService.data.currentHotel.next(e),this.router.navigateByUrl("/dashboard"),this.clean()},e=>{this.utils.presentErrorResponseMessage(e)})):e?this.hotelierApiSubscription=null===this.reservation.getValue()?this.hotelierApi.saveHotelInfo(e).subscribe(e=>{this.reservation.next(e),this.onNavigateResponse.next(!0),this.tokenService.setToken(e.id,"hotelInCreation")},e=>{this.utils.simplyError("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u0438\u0435"),this.onNavigateResponse.next(!0)}):this.hotelierApi.updateHotelInfo(this.utils.normalizeReservationData(i),this.reservation.getValue().id).subscribe(e=>{this.reservation.next(e),this.updateHandler.next(e),this.onNavigateResponse.next(!0),this.tokenService.setToken(e.id,"hotelInCreation")},e=>{this.utils.simplyError("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u0438\u0435"),this.onNavigateResponse.next(!0)}):this.onNavigateResponse.next(!0)}}return e.ngInjectableDef=u["\u0275\u0275defineInjectable"]({factory:function(){return new e(u["\u0275\u0275inject"](c.m),u["\u0275\u0275inject"](o.a),u["\u0275\u0275inject"](r.a),u["\u0275\u0275inject"](h.a),u["\u0275\u0275inject"](a.a))},token:e,providedIn:"root"}),e})()}}]);